(function(){"use strict";var e={5201:function(e,t,n){var s=n(4719),i=n(4314),o=(n(5823),n(3723));function a(e,t,n,s,i,a){const r=(0,o.up)("ConfigList");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(r)])}const r=e=>((0,o.dD)("data-v-fb314fde"),e=e(),(0,o.Cn)(),e),c={class:"container"},l=r((()=>(0,o._)("h2",null,"FRPC管理器-WebUI",-1))),u=r((()=>(0,o._)("h3",null,"全部配置文件",-1))),f=r((()=>(0,o._)("h3",null,"编辑器",-1)));function d(e,t,n,s,i,a){const r=(0,o.up)("el-table-column"),d=(0,o.up)("el-button"),g=(0,o.up)("el-table"),p=(0,o.up)("el-col"),h=(0,o.up)("el-row"),C=(0,o.up)("el-input");return(0,o.wg)(),(0,o.iD)("div",c,[l,(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{span:24},{default:(0,o.w5)((()=>[u,(0,o.Wm)(g,{data:i.configs,style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{prop:"name",label:"配置文件名"}),(0,o.Wm)(r,{label:"操作",width:"350"},{default:(0,o.w5)((e=>[(0,o.Wm)(d,{type:"primary",onClick:t=>a.startProcess(e.row.name),disabled:"运行中🟢"===e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("启动")])),_:2},1032,["onClick","disabled"]),(0,o.Wm)(d,{type:"danger",onClick:t=>a.stopProcess(e.row.name),disabled:"运行中🟢"!==e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("停止")])),_:2},1032,["onClick","disabled"]),(0,o.Wm)(d,{type:"warning",onClick:t=>a.showEditConfigDialog(e.row.name)},{default:(0,o.w5)((()=>[(0,o.Uk)("编辑")])),_:2},1032,["onClick"]),(0,o.Wm)(d,{type:"info",onClick:t=>a.deleteConfig(e.row.name),disabled:"运行中🟢"===e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("删除")])),_:2},1032,["onClick","disabled"])])),_:1}),(0,o.Wm)(r,{prop:"status",label:"状态"})])),_:1},8,["data"]),(0,o.Wm)(d,{class:"button-spacing",type:"primary",onClick:a.showCreateConfigDialog},{default:(0,o.w5)((()=>[(0,o.Uk)("新建配置文件")])),_:1},8,["onClick"])])),_:1})])),_:1}),i.showEditor?((0,o.wg)(),(0,o.j4)(h,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{span:24},{default:(0,o.w5)((()=>[f,(0,o.Wm)(C,{type:"text",modelValue:i.selectedConfig,"onUpdate:modelValue":t[0]||(t[0]=e=>i.selectedConfig=e),placeholder:"文件名",onChange:a.validateFileName,disabled:!i.isNewConfig},null,8,["modelValue","onChange","disabled"]),(0,o.Wm)(C,{class:"button-spacing",type:"textarea",modelValue:i.configContent,"onUpdate:modelValue":t[1]||(t[1]=e=>i.configContent=e),autosize:{minRows:10,maxRows:1/0},placeholder:"配置内容"},null,8,["modelValue"]),(0,o.Wm)(d,{class:"button-spacing",type:"primary",onClick:a.saveConfig},{default:(0,o.w5)((()=>[(0,o.Uk)("保存")])),_:1},8,["onClick"])])),_:1})])),_:1})):(0,o.kq)("",!0)])}var g=n(3483),p=n(6439),h=n.n(p),C={data(){return{configs:[],selectedConfig:null,configContent:"",showEditor:!1,processes:[],isNewConfig:!1}},methods:{getConfigs(){g.Z.get("/api/configs").then((e=>{this.configs=e.data.map((e=>{const t=this.processes.includes(e)?"运行中🟢":"已停止🔴";return{name:e,status:t}}))}))},getProcesses(){g.Z.get("/api/processes").then((e=>{this.processes=e.data,this.getConfigs()}))},showCreateConfigDialog(){this.showEditor=!0,this.selectedConfig="",this.configContent="",this.isNewConfig=!0},showEditConfigDialog(e){this.showEditor=!0,this.selectedConfig=e,this.isNewConfig=!1,this.getConfig()},deleteConfig(e){h().fire({title:"确认",text:"你确定要删除这个配置文件吗？",icon:"warning",showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then((t=>{t.isConfirmed&&g.Z.delete(`/api/configs/${e}`).then((e=>{"success"===e.data.status&&(this.getConfigs(),h().fire("删除成功","","success"))}))}))},getConfig(){this.selectedConfig&&g.Z.get(`/api/configs/${this.selectedConfig}`).then((e=>{this.configContent=e.data.content}))},saveConfig(){if(this.selectedConfig){const e={name:this.selectedConfig,content:this.configContent};if(this.isNewConfig)g.Z.post("/api/configs",e).then((e=>{"success"===e.data.status&&(this.getConfigs(),h().fire("保存成功","","success"))}));else{const t=`/api/configs/${this.selectedConfig}`;g.Z.put(t,e).then((e=>{"success"===e.data.status&&(this.getConfigs(),h().fire("保存成功","","success"))}))}}},startProcess(e){g.Z.post("/api/processes",{name:e}).then((e=>{"success"===e.data.status&&(this.getProcesses(),h().fire("启动成功","","success"))}))},stopProcess(e){h().fire({title:"确认",text:"你确定要停止这个进程吗？",icon:"warning",showCancelButton:!0,confirmButtonText:"停止",cancelButtonText:"取消"}).then((t=>{t.isConfirmed&&g.Z.delete(`/api/processes/${e}`).then((e=>{"success"===e.data.status&&(this.getProcesses(),h().fire("停止成功","","success"))}))}))},validateFileName(){const e=/^[\w\p{Script=Hani}.-]+(\.toml|\.ini|\.json|\.yaml)?$/u;e.test(this.selectedConfig)?this.isNewConfig&&this.configs.some((e=>e.name.split(".")[0]===this.selectedConfig.split(".")[0]))&&(h().fire("错误","文件名已存在","error"),this.selectedConfig=""):(h().fire("错误","文件名只能包含中文、字母、数字、下划线和点，如果有后缀，只能是toml、ini、json、yaml","error"),this.selectedConfig="")}},created(){this.getProcesses()}},w=n(1896);const m=(0,w.Z)(C,[["render",d],["__scopeId","data-v-fb314fde"]]);var b=m,v={components:{ConfigList:b}};const k=(0,w.Z)(v,[["render",a]]);var y=k;g.Z.defaults.baseURL="http://127.0.0.1:19999";const _=(0,s.ri)(y),W=(e,t)=>{let n=null;return function(){let s=this,i=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(s,i)}),t)}},x=window.ResizeObserver;window.ResizeObserver=class extends x{constructor(e){e=W(e,16),super(e)}},_.use(i.Z),_.mount("#app")}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,s,i,o){if(!s){var a=1/0;for(u=0;u<e.length;u++){s=e[u][0],i=e[u][1],o=e[u][2];for(var r=!0,c=0;c<s.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((function(e){return n.O[e](s[c])}))?s.splice(c--,1):(r=!1,o<a&&(a=o));if(r){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,i,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,o,a=s[0],r=s[1],c=s[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var u=c(n)}for(t&&t(s);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},s=self["webpackChunkfrpc_webui"]=self["webpackChunkfrpc_webui"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(5201)}));s=n.O(s)})();
//# sourceMappingURL=app.5233f804.js.map