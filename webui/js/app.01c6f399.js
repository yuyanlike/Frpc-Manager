(function(){"use strict";var e={292:function(e,t,i){var s=i(230),n=i(739),o=(i(823),i(384));function a(e,t,i,s,n,a){const r=(0,o.up)("ConfigList");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(r)])}var r=i(899);const l=e=>((0,o.dD)("data-v-53ec06fa"),e=e(),(0,o.Cn)(),e),c={class:"container"},f=l((()=>(0,o._)("h3",null,"全部配置文件",-1))),u=l((()=>(0,o._)("h3",null,"新建配置文件",-1))),d=l((()=>(0,o._)("h3",null,"获取远程配置",-1)));function p(e,t,i,s,n,a){const l=(0,o.up)("el-table-column"),p=(0,o.up)("el-button"),g=(0,o.up)("el-table"),h=(0,o.up)("el-col"),m=(0,o.up)("el-row"),w=(0,o.up)("el-input"),C=(0,o.up)("el-radio"),b=(0,o.up)("el-radio-group");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("h2",null,(0,r.zw)(n.VUE_APP_TITLE),1),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(h,{span:24},{default:(0,o.w5)((()=>[f,(0,o.Wm)(g,{data:n.configs,style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{prop:"name",label:"配置文件名",width:"300"}),(0,o.Wm)(l,{prop:"status",label:"状态",width:"300"}),(0,o.Wm)(l,{label:"操作",width:"350"},{default:(0,o.w5)((e=>[(0,o.Wm)(p,{type:"primary",onClick:t=>a.startProcess(e.row.name),disabled:"运行中🟢"===e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("启动 ")])),_:2},1032,["onClick","disabled"]),(0,o.Wm)(p,{type:"danger",onClick:t=>a.stopProcess(e.row.name),disabled:"运行中🟢"!==e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("停止 ")])),_:2},1032,["onClick","disabled"]),(0,o.Wm)(p,{type:"warning",onClick:t=>a.showEditConfigDialog(e.row.name)},{default:(0,o.w5)((()=>[(0,o.Uk)("编辑")])),_:2},1032,["onClick"]),(0,o.Wm)(p,{type:"info",onClick:t=>a.deleteConfig(e.row.name),disabled:"运行中🟢"===e.row.status},{default:(0,o.w5)((()=>[(0,o.Uk)("删除 ")])),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"]),(0,o.Wm)(p,{class:"button-spacing",type:"primary",onClick:a.showCreateConfigDialog},{default:(0,o.w5)((()=>[(0,o.Uk)("新建配置文件")])),_:1},8,["onClick"]),(0,o.Wm)(p,{class:"button-spacing",type:"primary",onClick:a.getRemoteApiConfigDialog},{default:(0,o.w5)((()=>[(0,o.Uk)("获取远程配置")])),_:1},8,["onClick"])])),_:1})])),_:1}),n.showEditor?((0,o.wg)(),(0,o.j4)(m,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{span:24},{default:(0,o.w5)((()=>[u,(0,o.Wm)(w,{type:"text",modelValue:n.selectedConfig,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedConfig=e),placeholder:"文件名",onChange:a.validateFileName,disabled:!n.isNewConfig},null,8,["modelValue","onChange","disabled"]),(0,o.Wm)(w,{class:"button-spacing",type:"textarea",modelValue:n.configContent,"onUpdate:modelValue":t[1]||(t[1]=e=>n.configContent=e),autosize:{minRows:10,maxRows:1/0},placeholder:"配置内容"},null,8,["modelValue"]),(0,o.Wm)(p,{class:"button-spacing",type:"primary",onClick:a.saveConfig},{default:(0,o.w5)((()=>[(0,o.Uk)("保存")])),_:1},8,["onClick"])])),_:1})])),_:1})):(0,o.kq)("",!0),n.showapiconfig?((0,o.wg)(),(0,o.j4)(m,{key:1},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{span:24},{default:(0,o.w5)((()=>[d,(0,o.Wm)(b,{modelValue:n.selectedApi,"onUpdate:modelValue":t[2]||(t[2]=e=>n.selectedApi=e),class:"ml-4"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{label:"muhanfrp",size:"large"},{default:(0,o.w5)((()=>[(0,o.Uk)("木韩FRP")])),_:1}),(0,o.Wm)(C,{label:"sakurafrp",size:"large"},{default:(0,o.w5)((()=>[(0,o.Uk)("樱花FRP")])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(w,{type:"text",modelValue:n.apiKeys[n.selectedApi],"onUpdate:modelValue":t[3]||(t[3]=e=>n.apiKeys[n.selectedApi]=e),placeholder:"请输入API密钥"},null,8,["modelValue"]),(0,o.Wm)(p,{class:"button-spacing",type:"primary",onClick:a.getRemoteApi},{default:(0,o.w5)((()=>[(0,o.Uk)("获取")])),_:1},8,["onClick"]),(0,o.Wm)(g,{data:n.remoteConfigs,style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{prop:"id",label:"ID",width:"300"}),(0,o.Wm)(l,{prop:"name",label:"名称",width:"300"}),(0,o.Wm)(l,{label:"操作",width:"350"},{default:(0,o.w5)((e=>[(0,o.Wm)(p,{type:"primary",onClick:t=>a.downloadConfig(e.row)},{default:(0,o.w5)((()=>[(0,o.Uk)("下载")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})):(0,o.kq)("",!0)])}var g=i(764),h=i(991),m=i.n(h),w=i(634),C={data(){return{configs:[],selectedConfig:null,configContent:"",showEditor:!1,processes:[],isNewConfig:!1,remoteConfigs:[],showapiconfig:!1,selectedApi:"muhanfrp",VUE_APP_TITLE:"FRPC管理器-WebUI",apiKeys:{muhanfrp:w.Z.get("muhanfrpApiKey")||"",sakurafrp:w.Z.get("sakurafrpApiKey")||""}}},methods:{getConfigs(){g.Z.get("/api/configs").then((e=>{this.configs=e.data.map((e=>{const t=this.processes.includes(e)?"运行中🟢":"已停止🔴";return{name:e,status:t}}))}))},getProcesses(){g.Z.get("/api/processes").then((e=>{this.processes=e.data,this.getConfigs()})).catch((e=>{console.error("获取数据时发生错误：",e),m().fire("Webui接口请求错误","","error")}))},showCreateConfigDialog(){this.showEditor=!0,this.selectedConfig="",this.configContent="",this.isNewConfig=!0,this.showapiconfig=!1},getRemoteApiConfigDialog(){this.showapiconfig=!0,this.showEditor=!1},showEditConfigDialog(e){this.showEditor=!0,this.showapiconfig=!1,this.selectedConfig=e,this.isNewConfig=!1,this.getConfig()},deleteConfig(e){m().fire({title:"确认",text:"你确定要删除这个配置文件吗？",icon:"warning",showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then((t=>{t.isConfirmed&&g.Z.delete(`/api/configs/${e}`).then((e=>{"success"===e.data.status?(this.getConfigs(),m().fire("删除成功","","success")):m().fire("删除失败",e.data.message,"error")}))}))},getConfig(){this.selectedConfig?g.Z.get(`/api/configs/${this.selectedConfig}`).then((e=>{this.configContent=e.data.content})):(this.configContent="",m().fire("请求错误","","error"))},saveConfig(){if(this.selectedConfig){const e={name:this.selectedConfig,content:this.configContent};if(this.isNewConfig)g.Z.post("/api/configs",e).then((e=>{"success"===e.data.status?(this.getConfigs(),m().fire("保存成功","","success")):m().fire("保存失败",e.data.message,"error")}));else{const t=`/api/configs/${this.selectedConfig}`;g.Z.put(t,e).then((e=>{"success"===e.data.status?(this.getConfigs(),m().fire("修改成功","","success")):m().fire("修改失败",e.data.message,"error")}))}}},startProcess(e){g.Z.post("/api/processes",{name:e}).then((e=>{"success"===e.data.status?(this.getProcesses(),m().fire("启动成功","","success")):m().fire("启动失败",e.data.message,"error")}))},stopProcess(e){m().fire({title:"确认",text:"你确定要停止这个进程吗？",icon:"warning",showCancelButton:!0,confirmButtonText:"停止",cancelButtonText:"取消"}).then((t=>{t.isConfirmed&&g.Z.delete(`/api/processes/${e}`).then((e=>{"success"===e.data.status?(this.getProcesses(),m().fire("停止成功","","success")):m().fire("停止失败",e.data.message,"error")}))}))},validateFileName(){const e=/^[\w\p{Script=Hani}.-]+(\.toml|\.ini|\.json|\.yaml)?$/u;e.test(this.selectedConfig)?this.isNewConfig&&this.configs.some((e=>e.name.split(".")[0]===this.selectedConfig.split(".")[0]))&&(m().fire("错误","文件名已存在","error"),this.selectedConfig=""):(m().fire("错误","文件名只能包含中文、字母、数字、下划线和点，如果有后缀，只能是toml、ini、json、yaml","error"),this.selectedConfig="")},getRemoteApi(){const e=this.selectedApi;console.log("当前选择的API: "+e),g.Z.get("api/get_configurations",{params:{api_channel:e,api_key:this.apiKeys[this.selectedApi]}}).then((e=>{e.data.length>0?(this.remoteConfigs=e.data,w.Z.set(this.selectedApi+"ApiKey",this.apiKeys[this.selectedApi])):m().fire("请求错误","","error")})).catch((()=>{m().fire("请求错误","","error")}))},downloadConfig(e){g.Z.get("/api/downloadConfig",{params:{config_id:e.id,config_name:e.name,api_key:this.apiKeys[this.selectedApi],api_channel:this.selectedApi}}).then((e=>{"success"===e.data.status?(m().fire("下载成功","","success"),this.getConfigs()):m().fire("下载失败",e.data.message,"error")})).catch((()=>{m().fire("请求错误","","error")}))}},created(){this.getProcesses()}},b=i(15);const y=(0,b.Z)(C,[["render",p],["__scopeId","data-v-53ec06fa"]]);var k=y,_={components:{ConfigList:k}};const v=(0,b.Z)(_,[["render",a]]);var W=v;g.Z.defaults.baseURL="";const A=(0,s.ri)(W),P=(e,t)=>{let i=null;return function(){let s=this,n=arguments;clearTimeout(i),i=setTimeout((function(){e.apply(s,n)}),t)}},U=window.ResizeObserver;window.ResizeObserver=class extends U{constructor(e){e=P(e,16),super(e)}},A.use(n.Z),A.mount("#app")}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,i),o.exports}i.m=e,function(){var e=[];i.O=function(t,s,n,o){if(!s){var a=1/0;for(f=0;f<e.length;f++){s=e[f][0],n=e[f][1],o=e[f][2];for(var r=!0,l=0;l<s.length;l++)(!1&o||a>=o)&&Object.keys(i.O).every((function(e){return i.O[e](s[l])}))?s.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(f--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var f=e.length;f>0&&e[f-1][2]>o;f--)e[f]=e[f-1];e[f]=[s,n,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,a=s[0],r=s[1],l=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var f=l(i)}for(t&&t(s);c<a.length;c++)o=a[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(f)},s=self["webpackChunkfrpc_webui"]=self["webpackChunkfrpc_webui"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(292)}));s=i.O(s)})();